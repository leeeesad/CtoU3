<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¥­å‹™å°æ²–åˆ©æ½¤ç²¾ç®—ç³»çµ±</title>
    <style>
        :root { --primary: #0984e3; --success: #00b894; --danger: #d63031; --dark: #2d3436; }
        body { font-family: -apple-system, sans-serif; background: #f0f2f5; display: flex; justify-content: center; padding: 15px; margin: 0; }
        .container { background: white; padding: 20px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); width: 100%; max-width: 550px; }
        h2 { text-align: center; color: var(--dark); margin-bottom: 20px; font-size: 20px; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        
        /* å€å¡Šæ¨£å¼ */
        .section { background: #f8f9fa; border-radius: 12px; padding: 15px; margin-bottom: 15px; border: 1px solid #e9ecef; }
        .section-title { font-size: 13px; font-weight: bold; color: var(--primary); margin-bottom: 12px; display: flex; align-items: center; gap: 5px; }
        
        /* ç¶²æ ¼ä½ˆå±€ */
        .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        
        /* è¼¸å…¥æ¡† */
        .input-group { margin-bottom: 10px; }
        label { display: block; margin-bottom: 4px; color: #636e72; font-size: 11px; }
        input { width: 100%; padding: 8px 10px; border: 1px solid #dfe6e9; border-radius: 6px; box-sizing: border-box; font-size: 14px; font-weight: 500; }
        input:focus { border-color: var(--primary); outline: none; background: #fff; }
        .cost-display { background: #e1f5fe; border: none; color: #01579b; font-weight: bold; }
        
        /* åˆ©æ½¤çµæœå¡ç‰‡ */
        .profit-card { display: flex; justify-content: space-between; align-items: center; padding: 12px; border-radius: 8px; margin-top: 8px; transition: 0.3s; }
        .path-a { background: #e8f8f5; border-left: 4px solid var(--success); }
        .path-b { background: #fff4e5; border-left: 4px solid #f39c12; }
        .profit-val { font-size: 18px; font-weight: bold; }
        
        .btn-sync { width: 100%; background: var(--primary); color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: bold; margin-bottom: 15px; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ“Š æ¥­å‹™å°æ²–èˆ‡åˆ©æ½¤ç²¾ç®—</h2>

    <button class="btn-sync" onclick="syncRates()">ğŸ”„ ç²å–å¯¦æ™‚åœ‹éš›ä¸­é–“åƒ¹</button>

    <div class="section">
        <div class="section-title">ğŸª™ è™›æ“¬å¹£ (U) æˆæœ¬éˆæ¢</div>
        <div class="grid-3">
            <div class="input-group">
                <label>äººâ†’U åŸºç¤</label>
                <input type="number" id="rmb_u_base" value="7.01" step="0.01" oninput="calc()">
            </div>
            <div class="input-group">
                <label>Uâ†’æ¸¯ åŸºç¤</label>
                <input type="number" id="hkd_u_base" value="7.85" step="0.01" oninput="calc()">
            </div>
            <div class="input-group">
                <label>Uâ†’æ¾³ åŸºç¤</label>
                <input type="number" id="mop_u_base" value="8.08" step="0.01" oninput="calc()">
            </div>
        </div>
        <div class="grid-3">
            <div class="input-group">
                <label>RMBä¸Šæµ®</label>
                <input type="number" id="rmb_u_up" value="0.15" step="0.01" oninput="calc()">
            </div>
            <div class="input-group">
                <label>æ¸¯å¹£ä¸‹æµ®</label>
                <input type="number" id="hkd_u_down" value="0.03" step="0.01" oninput="calc()">
            </div>
            <div class="input-group">
                <label>è‘¡å¹£ä¸‹æµ®</label>
                <input type="number" id="mop_u_down" value="0.03" step="0.01" oninput="calc()">
            </div>
        </div>
        <div class="grid-3">
            <input type="text" id="cost_rmb_u" class="cost-display" readonly>
            <input type="text" id="cost_hkd_u" class="cost-display" readonly>
            <input type="text" id="cost_mop_u" class="cost-display" readonly>
        </div>
    </div>

    <div class="section">
        <div class="section-title">ğŸ›ï¸ å¸‚å ´åŸºæº–åŒ¯ç‡</div>
        <div class="grid-2">
            <div class="input-group">
                <label>å ´å…§ äººâ†’æ¾³ (RMB/MOP)</label>
                <input type="number" id="market_rmb_mop" value="0.93" step="0.001" oninput="calc()">
            </div>
            <div class="input-group">
                <label>å ´å…§ æ¸¯â†’æ¾³ (HKD/MOP)</label>
                <input type="number" id="market_hkd_mop" value="1.0315" step="0.0001" oninput="calc()">
            </div>
        </div>
    </div>

    <div class="section" style="background: #fff;">
        <div class="section-title">ğŸ’° åˆ©æ½¤é»åˆ†æ (æ¯ 100 è‘¡å¹£)</div>
        <div class="profit-card path-a">
            <div>
                <div style="font-size: 12px; color: #16a085;">è·¯å¾‘ A: äººâ†’Uâ†’æ¾³</div>
                <div id="profit_a_desc" style="font-size: 11px; color: #7f8c8d;"></div>
            </div>
            <div id="profit_a" class="profit-val" style="color: #16a085;">0.00</div>
        </div>
        <div class="profit-card path-b">
            <div>
                <div style="font-size: 12px; color: #d35400;">è·¯å¾‘ B: äººâ†’Uâ†’æ¸¯â†’æ¾³</div>
                <div id="profit_b_desc" style="font-size: 11px; color: #7f8c8d;"></div>
            </div>
            <div id="profit_b" class="profit-val" style="color: #d35400;">0.00</div>
        </div>
    </div>

    <div class="section">
        <div class="section-title">ğŸ“± å¿«é€Ÿæ›ç®—</div>
        <div class="grid-2">
            <div class="input-group">
                <label>è¼¸å…¥è‘¡å¹£ (MOP)</label>
                <input type="number" id="input_mop" placeholder="5000" oninput="calc()">
            </div>
            <div class="input-group">
                <label>å°æ¯”ç›´æ¥æ”¶ RMB</label>
                <input type="text" id="compare_rmb" class="cost-display" readonly>
            </div>
        </div>
        <div id="real_rmb_cost" style="font-size: 13px; color: #2d3436; margin-top: 5px; font-weight: bold;">
            è·¯å¾‘Bå°æ²–æˆæœ¬: Â¥ 0.00
        </div>
    </div>
</div>

<script>
    async function syncRates() {
        try {
            const res = await fetch('https://open.er-api.com/v6/latest/USD');
            const data = await res.json();
            document.getElementById('rmb_u_base').value = data.rates.CNY.toFixed(2);
            document.getElementById('hkd_u_base').value = data.rates.HKD.toFixed(2);
            document.getElementById('mop_u_base').value = (data.rates.HKD * 1.031).toFixed(2);
            calc();
        } catch (e) { alert("åŒæ­¥å¤±æ•—"); }
    }

    function calc() {
        // 1. ç²å–è®Šé‡
        const r_u_b = parseFloat(document.getElementById('rmb_u_base').value) || 0;
        const r_u_u = parseFloat(document.getElementById('rmb_u_up').value) || 0;
        const h_u_b = parseFloat(document.getElementById('hkd_u_base').value) || 0;
        const h_u_d = parseFloat(document.getElementById('hkd_u_down').value) || 0;
        const m_u_b = parseFloat(document.getElementById('mop_u_base').value) || 0;
        const m_u_d = parseFloat(document.getElementById('mop_u_down').value) || 0;
        
        const m_rmb_mop = parseFloat(document.getElementById('market_rmb_mop').value) || 0;
        const m_hkd_mop = parseFloat(document.getElementById('market_hkd_mop').value) || 0;

        // 2. è¨ˆç®—å¯¦éš›æˆæœ¬
        const cost_ru = r_u_b + r_u_u;
        const cost_hu = h_u_b - h_u_d;
        const cost_mu = m_u_b - m_u_d;

        document.getElementById('cost_rmb_u').value = "æˆæœ¬: " + cost_ru.toFixed(2);
        document.getElementById('cost_hkd_u').value = "æˆæœ¬: " + cost_hu.toFixed(2);
        document.getElementById('cost_mop_u').value = "æˆæœ¬: " + cost_mu.toFixed(2);

        // 3. åˆ©æ½¤é»è¨ˆç®— (è¡¨æ ¼å…¬å¼é‚„åŸ)
        // è·¯å¾‘ A: äºº->U->æ¾³
        const u_path_a_rmb_cost = cost_ru / cost_mu;
        const profit_a = (m_rmb_mop - u_path_a_rmb_cost) * 100;
        
        // è·¯å¾‘ B: äºº->U->æ¸¯->æ¾³
        const u_path_b_mop_yield = cost_hu * m_hkd_mop;
        const u_path_b_rmb_cost = cost_ru / u_path_b_mop_yield;
        const profit_b = (m_rmb_mop - u_path_b_rmb_cost) * 100;

        document.getElementById('profit_a').innerText = profit_a.toFixed(4);
        document.getElementById('profit_b').innerText = profit_b.toFixed(4);
        document.getElementById('profit_a_desc').innerText = `1 MOP æˆæœ¬ Â¥${u_path_a_rmb_cost.toFixed(4)}`;
        document.getElementById('profit_b_desc').innerText = `1 MOP æˆæœ¬ Â¥${u_path_b_rmb_cost.toFixed(4)}`;

        // 4. å¿«é€Ÿæ›ç®—
        const inputMop = parseFloat(document.getElementById('input_mop').value) || 0;
        document.getElementById('compare_rmb').value = "Â¥ " + (inputMop * m_rmb_mop).toFixed(2);
        document.getElementById('real_rmb_cost').innerText = `è·¯å¾‘Bå°æ²–æˆæœ¬: Â¥ ${(inputMop * u_path_b_rmb_cost).toFixed(2)}`;
    }

    // åˆå§‹åŒ–è¨ˆç®—
    calc();
</script>

</body>
</html>
